---
title: "UygarSozer_finalbootcampex"
author: "Uygar Sozer"
date: "9/15/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Load required packages
library(tidyverse)
library(lubridate)
library(data.table)
```

```{r}
#Reading in the data
acs <- read.csv(here::here("data/nys_acs.csv"))
schools <- read.csv(here::here("data/nys_schools.csv"))
```

## Exploring the data
acs dataset contains no missing variables.
schools dataset does contain missing variables, coded in various ways. ("NA", "-99", "N/A" etc.)

```{r}
#Converts all -99 values to NA, input: vector, output: vector with NA
naconvert <- function(x) {
  x = na_if(x, -99)
}
#Mutate datasets with respect to -99 values
schools <- schools %>% mutate(across(.fns = naconvert))
acs <- acs %>% mutate(across(.fns = naconvert))
```

We will add a categorical variable poverty_level
```{r}
##pov_cutoff = quantile(acs$median_household_income, c(0.33, 0.66))
##acs %>% filter(median_household_income < pov_cutoff[1]) %>% mutate(poverty_level = "high")
##acs %>% filter(median_household_income >= pov_cutoff[1] & median_household_income < pov_cutoff[2] ) %>% mutate(poverty_level = "medium")
##acs %>% filter(median_household_income >= pov_cutoff[2]) %>% mutate(poverty_level = "low")

setDT(acs)
acs[median_household_income < pov_cutoff[1], poverty_level := "high"]
acs[median_household_income >= pov_cutoff[1] & median_household_income < pov_cutoff[2], poverty_level :="medium"]
acs[median_household_income >= pov_cutoff[2], poverty_level := "low"]
```

```{r}
setDT(schools)
schools[, z_ela_score := scale(mean_ela_score)]
schools[, z_math_score := scale(mean_math_score)]
```

```{r}
merged_schools <- merge(schools, acs, all.x = TRUE)
```


